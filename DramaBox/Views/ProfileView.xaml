<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="DramaBox.Views.ProfileView"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    Shell.NavBarIsVisible="False"
    NavigationPage.HasNavigationBar="False"
    NavigationPage.HasBackButton="False">

    <Grid Padding="18" RowSpacing="14">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Topo -->
        <Grid Grid.Row="0" ColumnDefinitions="*,Auto" VerticalOptions="Center">
            <Label Text="Perfil"
                   Style="{StaticResource TitleLargeLabelStyle}" />

            <Button Grid.Column="1"
                    Text="âš™"
                    BackgroundColor="Transparent"
                    WidthRequest="44"
                    HeightRequest="44"
                    CornerRadius="14" />
        </Grid>

        <ScrollView Grid.Row="1">
            <VerticalStackLayout Spacing="14">

                <!-- Card Perfil -->
                <Border Style="{StaticResource CardBorderStyle}">
                    <VerticalStackLayout Spacing="12">

                        <!-- Foto + Nome + Plano -->
                        <Grid ColumnDefinitions="Auto,*" ColumnSpacing="14" VerticalOptions="Center">

                            <!-- Avatar -->
                            <Grid WidthRequest="92" HeightRequest="92">
                                <Border StrokeThickness="0" WidthRequest="92" HeightRequest="92">
                                    <Border.StrokeShape>
                                        <RoundRectangle CornerRadius="46"/>
                                    </Border.StrokeShape>

                                    <!-- fundo degradÃª -->
                                    <Border.Background>
                                        <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                            <GradientStop Offset="0">
                                                <GradientStop.Color>
                                                    <AppThemeBinding Light="{StaticResource LightPrimaryColor}"
                                                                     Dark="{StaticResource DarkPrimaryColor}" />
                                                </GradientStop.Color>
                                            </GradientStop>
                                            <GradientStop Offset="1">
                                                <GradientStop.Color>
                                                    <AppThemeBinding Light="{StaticResource LightAccentColor}"
                                                                     Dark="{StaticResource DarkAccentColor}" />
                                                </GradientStop.Color>
                                            </GradientStop>
                                        </LinearGradientBrush>
                                    </Border.Background>

                                    <Grid>
                                        <Image x:Name="ProfileImage"
                                               Aspect="AspectFill"
                                               IsVisible="False"/>

                                        <Label x:Name="InitialsLabel"
                                               Text="DL"
                                               TextColor="White"
                                               FontSize="28"
                                               FontAttributes="Bold"
                                               HorizontalTextAlignment="Center"
                                               VerticalTextAlignment="Center" />
                                    </Grid>
                                </Border>

                                <!-- BotÃ£o de editar foto -->
                                <Border
                                    HorizontalOptions="End"
                                    VerticalOptions="End"
                                    Margin="0,0,-6,-6"
                                    StrokeThickness="0"
                                    WidthRequest="34"
                                    HeightRequest="34">
                                    <Border.StrokeShape>
                                        <RoundRectangle CornerRadius="17"/>
                                    </Border.StrokeShape>
                                    <Border.Background>
                                        <AppThemeBinding Light="{StaticResource LightSurfaceColor}"
                                                         Dark="{StaticResource DarkSurfaceColor}" />
                                    </Border.Background>

                                    <Button Text="âœŽ"
                                            FontSize="14"
                                            BackgroundColor="Transparent"
                                            Clicked="OnChangePhotoClicked"/>
                                </Border>
                            </Grid>

                            <!-- Infos -->
                            <VerticalStackLayout Spacing="6" VerticalOptions="Center">
                                <Label x:Name="NameLabel"
                                       Text="â€”"
                                       FontSize="18"
                                       FontAttributes="Bold" />

                                <!-- Badge Plano -->
                                <Border x:Name="PlanBadge"
                                        StrokeThickness="0"
                                        Padding="10,6"
                                        HorizontalOptions="Start">
                                    <Border.StrokeShape>
                                        <RoundRectangle CornerRadius="14"/>
                                    </Border.StrokeShape>
                                    <Border.Background>
                                        <AppThemeBinding Light="{StaticResource LightSurfaceSecondaryColor}"
                                                         Dark="{StaticResource DarkSurfaceSecondaryColor}" />
                                    </Border.Background>

                                    <HorizontalStackLayout Spacing="8">
                                        <Label Text="â˜…"
                                               FontAttributes="Bold"
                                               TextColor="{StaticResource AppMutedTextColor}" />
                                        <Label x:Name="PlanLabel"
                                               Text="Free"
                                               FontAttributes="Bold"
                                               FontSize="13"
                                               TextColor="{StaticResource AppMutedTextColor}" />
                                    </HorizontalStackLayout>
                                </Border>

                                <Label Text="Conta e estatÃ­sticas (mock)"
                                       Style="{StaticResource MutedLabelStyle}" />
                            </VerticalStackLayout>
                        </Grid>

                        <!-- Stats placeholders (vamos fazer depois) -->
                        <Grid ColumnDefinitions="*,*" ColumnSpacing="10" Margin="0,6,0,0">
                            <Border Style="{StaticResource CardBorderStyle}" Padding="12">
                                <Label Text="â¤ï¸ curtidas (depois)"
                                       FontAttributes="Bold"
                                       FontSize="13"
                                       HorizontalTextAlignment="Center"/>
                            </Border>

                            <Border Grid.Column="1" Style="{StaticResource CardBorderStyle}" Padding="12">
                                <Label Text="ðŸ“Œ salvos (depois)"
                                       FontAttributes="Bold"
                                       FontSize="13"
                                       HorizontalTextAlignment="Center"/>
                            </Border>
                        </Grid>

                        <Border Style="{StaticResource CardBorderStyle}" Padding="12">
                            <Label Text="episÃ³dios publicados (depois)"
                                   FontAttributes="Bold"
                                   HorizontalTextAlignment="Center" />
                        </Border>

                    </VerticalStackLayout>
                </Border>

                <!-- Assinatura -->
                <Border Style="{StaticResource CardBorderStyle}">
                    <VerticalStackLayout Spacing="8">
                        <Label Text="Assinatura" Style="{StaticResource TitleMediumLabelStyle}" />
                        <Label Text="Gerencie seu plano."
                               Style="{StaticResource MutedLabelStyle}" />

                        <!-- botÃ£o com tema (sem depender de AppPrimaryColor) -->
                        <Border StrokeThickness="0">
                            <Border.StrokeShape>
                                <RoundRectangle CornerRadius="14"/>
                            </Border.StrokeShape>

                            <Border.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                    <GradientStop Offset="0">
                                        <GradientStop.Color>
                                            <AppThemeBinding Light="{StaticResource LightPrimaryColor}"
                                                             Dark="{StaticResource DarkPrimaryColor}" />
                                        </GradientStop.Color>
                                    </GradientStop>
                                    <GradientStop Offset="1">
                                        <GradientStop.Color>
                                            <AppThemeBinding Light="{StaticResource LightAccentColor}"
                                                             Dark="{StaticResource DarkAccentColor}" />
                                        </GradientStop.Color>
                                    </GradientStop>
                                </LinearGradientBrush>
                            </Border.Background>

                            <Button Text="Abrir planos"
                                    Style="{StaticResource GradientButtonStyle}"
                                    BackgroundColor="Transparent"
                                    Clicked="OnOpenUpgradeClicked" />
                        </Border>
                    </VerticalStackLayout>
                </Border>

                <!-- Sair -->
                <Border Style="{StaticResource CardBorderStyle}">
                    <Button Text="Sair"
                            Style="{StaticResource OutlineButtonStyle}"
                            Clicked="OnLogoutClicked"/>
                </Border>

                <BoxView HeightRequest="8" Opacity="0" />
            </VerticalStackLayout>
        </ScrollView>
    </Grid>
</ContentPage>
